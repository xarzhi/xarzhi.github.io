# fs 文件系统模块

## 1.作用

fs（file system） 文件系统模块可以进行文件的创建、删除、重命名、移动， 文件内容的写入、读取， 以及文件夹的相关操作。



## 2.fs的异步和同步

fs 模块对文件的操作有异步和同步两种方式

区别:

- 同步调用会阻塞代码的执行，异步不会
- 异步调用会将读取任务下达到任务队列，直到任务执行完成才会回调，效率高
- 异常处理：同步必须要使用 `try catch` 方式，异步可以使用回调函数的第一个参数 err 【重要】
- 语法方面：同步方法会比异步方法后面多上`Sync`，例如：`readFile()` 和 `readFileSync()`，同步方法没有回调



## 3.文件的读取

在node中读取文件的方式有来两种，一个是利用fs模块，一个是利用流来读取。

- 如果读取小文件，我们可以使用fs读取，fs读取文件的时候，是将文件一次性读取到本地内存。
- 而如果读取一个大文件，一次性读取会占用大量内存，效率很低，这个时候需要用流来读取。

流是将数据分割段，一段一段的读取，可以控制速率,效率很高,不会占用太大的内存。gulp的task任务，文件压缩，和http中的请求和响应等功能的实现都是基于流来实现的。

### 3.1 readFile()

#### 3.1.1 作用

**异步**地读取一个文件的**全部内容**，文件的内容由回调函数中的`data`获取

#### 3.1.2 语法

```js
fs.readFile(path[, options], callback)
```

- **path**：要读取文件的路径
- **options**：文件字符编码
  - 若传参数，一般是`utf8`
  - 若不传参数，则读出的文件是`buffer`数据格式
- **callback**：读取完成后的回调，有两个参数
  - **err**：读取错误后的错误信息
  - **data**：读取成功后的**文件内容**

#### 3.1.3 示例

> text.txt

```txt
12345,上山打老虎
```

> index.js

```js
const fs = require('fs');
// 指定字符格式
fs.readFile('./text.txt','utf8',(err,data)=>{
    if(err){
        console.log(err);
    }else{
        console.log(data);  // 12345,上山打老虎
    }
})

// 不指定字符格式
const fs = require('fs');
fs.readFile('./text.txt',(err,data)=>{
    if(err){
        console.log(err);
    }else{
        console.log(data); 
        // <Buffer 31 32 33 34 35 2c e4 b8 8a e5 b1 b1 e6 89 93 e8 80 81 e8 99 8e>
    }
})
```



### 3.2 readFileSync()

#### 3.2.1 作用

**同步**地读取一个文件的**全部内容**，文件的内容由该函数的返回值获取

#### 3.2.2 语法

```js
fs.readFileSync(path[, options])
```

- **path**：要读取文件的路径
- **options**：文件字符编码
  - 若传参数，一般是`utf8`
  - 若不传参数，则读出的文件是`buffer`数据格式

#### 3.2.3 示例

```js
const fs = require('fs');
// 指定字符格式
const text=fs.readFileSync('./text.txt','utf8')
console.log(text); // 12345,上山打老虎

// 不指定字符格式
const text=fs.readFileSync('./text.txt')
console.log(text); 
// <Buffer 31 32 33 34 35 2c e4 b8 8a e5 b1 b1 e6 89 93 e8 80 81 e8 99 8e>
```

### 3.3 createReadStream

#### 3.3.1 作用

```js
const fs = require('fs');
const  rs = fs.createReadStream('./text.txt');
// 3、绑定data事件
rs.on('data',chunk=>{
    console.log(chunk);
    console.log(chunk.length);
});
rs.on('end',()=>{
    // 提供效率
    console.log("读取完成");
});
```

#### 3.3.2 语法

#### 3.3.3 示例

```js

```



## 4.文件的写入

### 4.1 同步写入

### 4.2 异步写入

### 4.3 追加写入

### 4.4 流式写入

### 4.5 使用场景



## 5.文件重命名

### 5.1 重命名

### 5.2 文件移动



## 6.操作文件夹

### 6.1 场景文件夹

### 6.2 读取文件夹

### 6.3 删除文件夹