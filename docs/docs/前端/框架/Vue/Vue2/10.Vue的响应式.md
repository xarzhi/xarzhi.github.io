# Vue的响应式

Vue的响应式也就是据模型仅仅是普通的 JavaScript 对象。而当你修改它们时，视图中的数据会进行更新

Vue的响应式是通过[`Object.defineProperty()`](../../../前端三剑客/javascript/js基础/07.对象Object#object-defineproperty)方法实现的，在处理基本数据时没有问题，但是在处理有层级的数据，比如数组、对象，则会有一些问题

如下所示，通过下标修改数组里的数据，发现并没有卵用

```vue
<template>
	<div>
		<button @click="change">点击</button>
		{{ arr[0] }}
	</div>
</template>
<script>
export default {
	name: 'App',

	data() {
		return {
			arr: [1],
		}
	},
	methods: {
		change() {
			this.arr[0] = 2
		},
	},
}
</script>

```

![PixPin_2024-10-18_15-54-44](https://gitee.com/xarzhi/picture/raw/master/img/PixPin_2024-10-18_15-54-44.gif)

但是当我们打印该值，发现确实已经发生了改变

```js
change() {
    this.arr[0] = 2
    console.log(this.arr[0])
},
```

![PixPin_2024-10-18_15-55-34](https://gitee.com/xarzhi/picture/raw/master/img/PixPin_2024-10-18_15-55-34.gif)



这是因为`Object.defineProperty()`无法监听到数组值的改变，也无法监听到对象是否新增了键



:::tip

vue会监视data中所有层次的数据

对于对象：

- 通过setter实现监视，且要在new Vue()时就传入要监测的数据

- 对象创建后追加的属性，Vue默认不做响应式处理

- 如需给后添加的属性做响应式，请使用如下API

  1. `this.set(target,propertyName/index,value)`

对于数组：

- 通过包裹数组更新元素的方法实现，本质就是做了两件事

- 调用原生对应的方法对数组进行更新

- 重新解析模板，进而更新页面

- 在Vue修改数组中的某个元素一定要用如下方法

- push()pop()unshift()shift()splice()sort()reverse()这几个方法被Vue重写了Vue.set()或vm.$set()

:::



## $set()

$set()是Vue原型上的一个方法，可直接通过this调用

用于修改数组中某个值，或者给对象添加新的键之后，更新视图中的值

```js
$set(target, propertyName/index, value)
```

参数：

- target：data中的对象或者数组，也可以是this
- propertyName/index：数组的下标或者对象的键名
- value：新的值



## $forceupdate()

$forceupdate()是Vue原型上的一个方法，可直接通过this调用，用于更新整个视图

不过不推荐使用，因为是更新整个视图

